var validatorMap={required:[LANG_formplus.validate.required,function(b,a){return null!=a&&""!=a}],number:[LANG_formplus.validate.number,function(b,a){return!isNaN(a)&&!/^\s+$/.test(a)}],msn:[LANG_formplus.validate.msn,function(b,a){return null==a||""==a||/\S+@\S+/.test(a)}],skype:[LANG_formplus.validate.skype,function(b,a){return!/\W/.test(a)||/^[a-zA-Z0-9]+$/.test(a)}],digits:[LANG_formplus.validate.digits,function(b,a){return!/[^\d]/.test(a)}],unsignedint:[LANG_formplus.validate.unsignedint,function(b,
a){return!/[^\d]/.test(a)&&0<a}],unsigned:[LANG_formplus.validate.unsigned,function(b,a){return!isNaN(a)&&!/^\s+$/.test(a)&&0<=a}],positive:[LANG_formplus.validate.positive,function(b,a){return!isNaN(a)&&!/^\s+$/.test(a)&&0<a}],alpha:[LANG_formplus.validate.alpha,function(b,a){return null==a||""==a||/^[a-zA-Z]+$/.test(a)}],alphaint:[LANG_formplus.validate.alphaint,function(b,a){return!/\W/.test(a)||/^[a-zA-Z0-9]+$/.test(a)}],alphanum:[LANG_formplus.validate.alphanum,function(b,a){return!/\W/.test(a)||
/^[\u4e00-\u9fa5a-zA-Z0-9]+$/.test(a)}],unzhstr:[LANG_formplus.validate.unzhstr,function(b,a){return!/\W/.test(a)||!/^[\u4e00-\u9fa5]+$/.test(a)}],date:[LANG_formplus.validate.date,function(b,a){return null==a||""==a||/^(19|20)[0-9]{2}-([1-9]|0[1-9]|1[012])-([1-9]|0[1-9]|[12][0-9]|3[01])$/.test(a)}],email:[LANG_formplus.validate.email,function(b,a){return null==a||""==a||/(\S)+[@]{1}(\S)+[.]{1}(\w)+/.test(a)}],mobile:[LANG_formplus.validate.mobile,function(b,a){return null==a||""==a||/^0?1[3458]\d{9}$/.test(a)}],
tel:[LANG_formplus.validate.tel,function(b,a){return null==a||""==a||/^(0\d{2,3}-?)?[23456789]\d{5,7}(-\d{1,5})?$/.test(a)}],phone:[LANG_formplus.validate.phone,function(b,a){return null==a||""==a||/^0?1[3458]\d{9}$|^(0\d{2,3}-?)?[23456789]\d{5,7}(-\d{1,5})?$/.test(a)}],zip:[LANG_formplus.validate.zip,function(b,a){return null==a||""==a||/^\d{6}$/.test(a)}],url:[LANG_formplus.validate.url,function(b,a){return null==a||""==a||/^(http|https|ftp):\/\/([A-Z0-9][A-Z0-9_-]*)(:(\d+))?\/?/i.test(a)}],area:[LANG_formplus.validate.area,
function(b){return b.getElements("select").every(function(a){if(!a.isDisplay())return!0;a=a.get("value");return""!=a&&"_NULL_"!=a})}],requiredcheckbox:[LANG_formplus.validate.requiredonly,function(b,a,c){c=c||b.get("type");a=b.getParent();b=(b=b.get("name"))?a.getElements("input[type="+c+'][name="'+b+'"]'):a.getElements("input[type="+c+"]");return b.some(function(a){return!0==a.checked})}],requiredradio:[LANG_formplus.validate.requiredonly,function(b,a,c){c=c||b.get("type");a=b.getParent();b=(b=b.get("name"))?
a.getElements("input[type="+c+'][name="'+b+'"]'):a.getElements("input[type="+c+"]");return b.some(function(a){return!0==a.checked})}]},validate=function(b){b=b||0===b?document.id(b):null;if(!b)return!0;var a=b.match("form")?b.getElements("[vtype]"):[b],c=new Elements;a.each(function(a){var b=a.get("vtype");if(!b||!a.isDisplay())return!0;b=b.split("&&");a.get("required")&&(b=["required"].combine(b.clean()));b.every(function(b){b=validatorMap[b];if(!b)return!0;var e=a.getNext(".caution"),c=a.get("caution")||
b[0],b=b[1]||function(){return!0};if(b(a,a.get("value"),a.get("type")))return e&&e.destroy(),!0;(e||(new Element("span",{"class":"error caution notice-inline"})).inject(a,"after")).set("html",c);var i=["input","select","textarea"].contains(a.get("tag"))?"onblur":"onmouseout";a[i]=function(b){b=new Event(b);"mouseout"==b.type&&a.contains($(b.target))||validate(this);a[i]=null};return!1})||c.include(a)});return c.length?(b.match("form")&&(new Fx.Scroll(window,{link:"cancel"})).toElement(c.shift()),
!1):!0};
(function(){var b=this.Sync=new Class({Extends:Request.HTML,options:{syncCache:!1,disabled:"disabled",loadtip:"loading",tipCls:"-tip",ajaxTip:"ajax-tip",tipHidden:!1,position:"before",evalScripts:!0},initialize:function(a,b){(this.sponsor=a)&&(b=this._getOptions(a,b));this.parent(b)},_getOptions:function(a,b){var b=b||{},c;try{c=JSON.decode(a.get("data-ajax-config"))||{}}catch(d){c={}}var i,j="submit"===a.type?!0:!1;j&&(i=this.dataForm=a.getParent("form")||{});i=j?{data:i,url:i.action,method:i.method||"post"}:
{url:a.get("href"),method:"get"};return c=Object.merge(i,b,a.retrieve("_ajax_config",{}),c)},_nearText:function(a){for(var b=a,c;a;){c=a.lastChild;"whitespace"===typeOf(c)&&(c=c.previousSibling);if(c&&3===c.nodeType)return $(a);a=c}return b},_defaultState:function(){this.sponsor&&this.sponsor.removeClass(this.options.disabled).retrieve("default:state",function(){})();return this},onFailure:function(){this._defaultState().parent()},_validate:function(a){return validate(a)},_getCache:function(a){return a.retrieve("ajax:cache",
!1)},_clearCache:function(a){a.eliminate("ajax:cache")},_setCache:function(a,b){a&&a.store("ajax:cache",b)},_progressCache:function(a){if(a=this._getCache(a))return a.success(a.response.data)||!0},success:function(a,b){this.response.data=a;if(/text\/jcmd/.test(this.getHeader("Content-type")))return this._jsonSuccess(a);if(["update","append","filter"].some(function(a){return this.options[a]},this))return this.parent(a,b);this.onSuccess(this.processScripts(a),b)},_jsonSuccess:function(a){var b;try{b=
this.response.json=JSON.decode(a)}catch(c){b=null}this.onSuccess(b)},onSuccess:function(a){this._defaultState();this.response.json&&this._progress(a);this._setCache(this.sponsor,this);this.parent(arguments)},_progress:function(a){if(a){var b=a.redirect,c;["error","success"].each(function(b){c=a[b];if(this.options.inject&&c){if(b!=this.options.tipHidden)return this._injectTip(b,c);this._clearTip(b,c)}},this);if(c=a.error){var d=this.options.progress?this.options.progress(a):!0;if(c&&!1!==d)return Message(c,
"error",function(){b?"back"==b?history.back():"reload"==b?location.reload():location.href=b:this._defaultState()}.bind(this))}else if(c=a.success)return Message(c,"success",function(){c&&b&&("back"==b?history.back():"reload"==b?location.reload():location.href=b)})}},_clearTip:function(){this.inject&&this.tipElem&&this.tipElem.destroy()},_injectTip:function(a,b){var c=this.options,d=this.inject=document.id(c.inject),i=c.position,j=c.ajaxTip,a=a+c.tipCls;if(d){if((c=d.getParent())&&(this.tipElem=c.getElement("."+
j)))return this.tipElem.set("html",b);(new Element("div",{"class":a+" "+j})).set("html",b).inject(d,i)}},_request:function(a){if(!a)return this;a.addClass(this.options.disabled);var b,c,d;if(b={INPUT:"value",BUTTON:"html"}[a.tagName])c=a.get(b),d=this._nearText(a),d.set(b,this.options.loadtip);a.retrieve("default:state")||a.store("default:state",function(){a&&a.set(b,c)});return this},_isCheck:function(a,b){var b=b||{},c=this.dataForm||b.data||this.options.data;return"element"===typeOf(c)&&!this._validate(c)?
!1:!0},send:function(a){var b=this.sponsor;(!b||!(b.hasClass(this.options.disabled)||!this._isCheck(b,a)||this.options.syncCache&&this._progressCache(b)))&&this._request(b).parent(a)}}),a=function(a,c,d){if(a.hasClass("disabled"))return!1;if(d){if(!validate(d))return a.removeClass("disabled"),!1;if(!a.get("isDisabled"))return a.addClass("disabled")}if(sync=a.retrieve("ajax:cache",!1))return sync.send();sync=(new b(a)).send()},c=this.Ex_Event_Group={_request:{fn:a}},d=function(a,b){for(var c=3;c&&
a&&9!==a.nodeType;c--){if("submit"===a.type||$(a)&&$(a).get(b))return a;a=a.parentNode}};$(document.documentElement||document.body).addEvent("click",function(b){var h=$(b.target),g;if(g=d(h,"rel")){if("submit"===g.type&&"_request"!==g.get("rel"))return a(g,b,g.getParent("form"));var h=g.get("rel"),f=c[h];if(f){var i=f.fn,f=f.loader;b.preventDefault();if($(g).get&&$(g).get(h))return g;f?Ex_Loader(h,function(){i&&i(g,b)}):i&&i(g,b)}}})})();
var Asset={javascript:function(b,a){a=Object.append({document:document},a);a.onLoad&&(a.onload=a.onLoad,delete a.onLoad);var c=new Element("script",{src:b,type:"text/javascript"}),d=a.onload||function(){},e=a.document;delete a.onload;delete a.document;return c.addEvents({load:d,readystatechange:function(){["loaded","complete"].contains(this.readyState)&&d.call(this)}}).set(a).inject(e.head)},css:function(b,a){a||(a={});var c=new Element("link",{rel:"stylesheet",media:"screen",type:"text/css",href:b}),
d=a.onload||a.onLoad,e=a.document||document;delete a.onload;delete a.onLoad;delete a.document;d&&c.addEvent("load",d);return c.set(a).inject(e.head)},image:function(b,a){var a=Object.merge({onload:function(){},onabort:function(){},onerror:function(){}},a),c=new Image,d=document.id(c)||new Element("img");["load","abort","error"].each(function(b){var h="on"+b,g=b.capitalize();a["on"+g]&&(a[h]=a["on"+g],delete a["on"+g]);var f=a[h];delete a[h];c[h]=function(){if(c){if(!d.parentNode){d.width=c.width;
d.height=c.height}c=c.onload=c.onabort=c.onerror=null;f.delay(1,d,d);d.fireEvent(b,d,1)}}});c.src=d.src=b;c&&c.complete&&c.onload.delay(1);return d.set(a)},images:function(b,a){var a=Object.merge({onComplete:function(){},onProgress:function(){},onError:function(){},properties:{}},a),b=Array.from(b),c=0;return new Elements(b.map(function(d,e){return Asset.image(d,Object.append(a.properties,{onload:function(){c++;a.onProgress.call(this,c,e,d);if(c==b.length)a.onComplete()},onerror:function(){c++;a.onError.call(this,
c,e,d);if(c==b.length)a.onComplete()}}))}))}};
(function(){this.Tips=new Class({Implements:[Events,Options],options:{onShow:function(){this.tip.setStyle("visibility","visible")},onHide:function(){this.tip.setStyle("visibility","hidden")},title:"title",text:function(b){return b.get("rel")||b.get("href")},showDelay:100,hideDelay:100,className:"tip",offset:{x:16,y:16},windowPadding:{x:0,y:0},fixed:!1},initialize:function(){var b=Array.link(arguments,{options:Type.isObject,elements:function(a){return null!=a}});this.setOptions(b.options);b.elements&&
this.attach(b.elements);this.container=new Element("div",{"class":"tip"})},toElement:function(){return this.tip?this.tip:this.tip=(new Element("div",{"class":this.options.className,styles:{position:"absolute",top:0,left:0}})).adopt(new Element("div",{"class":"tip-top"}),this.container,new Element("div",{"class":"tip-bottom"}))},attach:function(b){$$(b).each(function(a){var b=this.options.title?"function"==typeOf(this.options.title)?(0,this.options.title)(a):a.get(this.options.title):"",d=this.options.text?
"function"==typeOf(this.options.text)?(0,this.options.text)(a):a.get(this.options.text):"";a.set("title","").store("tip:native",b).retrieve("tip:title",b);a.retrieve("tip:text",d);this.fireEvent("attach",[a]);b=["enter","leave"];this.options.fixed||b.push("move");b.each(function(b){var c=a.retrieve("tip:"+b);c||(c=function(c){this["element"+b.capitalize()].apply(this,[c,a])}.bind(this));a.store("tip:"+b,c).addEvent("mouse"+b,c)},this)},this);return this},detach:function(b){$$(b).each(function(a){["enter",
"leave","move"].each(function(b){a.removeEvent("mouse"+b,a.retrieve("tip:"+b)).eliminate("tip:"+b)});this.fireEvent("detach",[a]);if("title"==this.options.title){var b=a.retrieve("tip:native");b&&a.set("title",b)}},this);return this},elementEnter:function(b,a){this.container.empty();["title","text"].each(function(b){var d=a.retrieve("tip:"+b);d&&this.fill((new Element("div",{"class":"tip-"+b})).inject(this.container),d)},this);clearTimeout(this.timer);this.timer=function(){this.show(a);this.position(this.options.fixed?
{page:a.getPosition()}:b)}.delay(this.options.showDelay,this)},elementLeave:function(b,a){clearTimeout(this.timer);this.timer=this.hide.delay(this.options.hideDelay,this,a);this.fireForParent(b,a)},fireForParent:function(b,a){(a=a.getParent())&&a!=document.body&&(a.retrieve("tip:enter")?a.fireEvent("mouseenter",b):this.fireForParent(b,a))},elementMove:function(b){this.position(b)},position:function(b){this.tip||document.id(this);var a=window.getSize(),c=window.getScroll(),d={x:this.tip.offsetWidth,
y:this.tip.offsetHeight},e={x:"left",y:"top"},h={y:!1,x2:!1,y2:!1,x:!1},g={},f;for(f in e)g[e[f]]=b.page[f]+this.options.offset[f],0>g[e[f]]&&(h[f]=!0),g[e[f]]+d[f]-c[f]>a[f]-this.options.windowPadding[f]&&(g[e[f]]=b.page[f]-this.options.offset[f]-d[f],h[f+"2"]=!0);this.fireEvent("bound",h);this.tip.setStyles(g)},fill:function(b,a){"string"==typeof a?b.set("html",a):b.adopt(a)},show:function(b){this.tip||document.id(this);this.tip.getParent()||this.tip.inject(document.body);this.fireEvent("show",
[this.tip,b])},hide:function(b){this.tip||document.id(this);this.fireEvent("hide",[this.tip,b])}})})();
Element.implement({zoomImg:function(b,a,c){if("img"==this.get("tag")&&this.width){var d={width:this.width,height:this.height},e;if(d.width<=b&&d.height<=a)return c?d:null;d.width>b&&(e=(b/d.width).toFloat(),d=(d.height*e).toInt(),d={width:b,height:d});d.height>a&&(e=(a/d.height).toFloat(),b=(d.width*e).toInt(),d={width:b,height:a});return!c?this.set(d):d}},hide:function(){var b;try{b=this.getStyle("display")}catch(a){}return"none"==b?this:this.store("element:_originalDisplay",b||"").setStyle("display",
"none")},show:function(b){if(!b&&this.isDisplay())return this;this.fireEvent("onshow",this);b=b||this.retrieve("element:_originalDisplay")||"";return this.setStyle("display","none"==b?"block":b)},isDisplay:function(){return"none"!==this.getStyle("display")&&0<this.offsetWidth+this.offsetHeight},getPatch:function(){var b=arguments.length?Array.from(arguments):["margin","padding","border"],a={x:0,y:0};Object.each({x:["left","right"],y:["top","bottom"]},function(c,d){c.each(function(c){try{b.each(function(b){b+=
"-"+c;"border"==b&&(b+="-width");a[d]+=this.getStyle(b).toInt()||0},this)}catch(h){}},this)},this);return a},outerSize:function(){return"none"===this.getStyle("display")?{x:0,y:0}:{x:this.getSize().x+this.getPatch("margin").x,y:this.getSize().y+this.getPatch("margin").y}}});
(function(){function b(a,b){var d=a.getSize(),e,b=b||{x:"center",y:"center"};switch(b.x.toString().toLowerCase()){case "0":case "left":case "l":e=0;break;case "100%":case "right":case "r":e=d.x;break;case "50%":case "center":case "c":e=d.x/2;break;default:e=b.x.toInt()||0}switch(b.y.toString().toLowerCase()){case "0":case "top":case "t":d=0;break;case "100%":case "bottom":case "b":d=d.y;break;case "50%":case "center":case "c":case "m":d=d.y/2;break;default:d=b.y.toInt()||0}return{x:e,y:d}}Element.implement({position:function(a){a=
Object.merge({target:document.body,to:{x:"center",y:"center"},base:{x:"center",y:"center"},offset:{x:0,y:0},intoView:!1},a);this.setStyle("position","absolute");var c=a.target||$(document.body),d=b(this,a.base),e=b(c,a.to),h=e.x-d.x+c.getPosition().x+c.getScroll().x+a.offset.x,c=e.y-d.y+c.getPosition().y+c.getScroll().y+a.offset.y;"in"===a.intoView&&(h=h.limit(0,window.getScroll().x+window.getSize().x-this.getSize().x),c=c.limit(0,window.getScroll().y+window.getSize().y-this.getSize().y));this.setStyles({left:h,
top:c});if(!0===a.intoView||"to"===a.intoView)try{(new Fx.Scroll(document)).toElementEdge(this)}catch(g){}return this}})})();
_open=function(b,a){a=a||{};a.width&&1>=a.width&&(a.width*=window.getSize().x);a.height&&1>=a.height&&(a.height*=window.getSize().y);var a=Object.append({width:a.maxmize?screen.availWidth:0.8*window.getSize().x,height:a.maxmize?screen.availHeight:0.9*window.getSize().y,left:0,top:0,scrollbars:"yes",resizable:"yes"},a),c;c="toolbar=no,location=no,status=no,menubar=no,scrollbars={scrollbars},resizable={resizable},top={top},left={left},width={width},height={height}".substitute(a);window.open(b||"about:blank",
"_blank",c)};
var timeCount=new Class({init:function(b,a,c,d){this.isReload=d||!0;d=Math.abs((b.getTime()-a.getTime())/1E3);b=d%60;a=(d-b)/60%60;d=(d-b-60*a)/3600;if(24<d)var e=parseInt(d/24),b=[d-24*e,a,b,e];else b=[d,a,b];this.s=this.calcTime.periodical(1E3,this,{time:b,dom:c});document.getElement(".desc")&&(this.desc=10,this.d=this.calcDesc.periodical(100,this),function(){$("timer").setStyle("display","block")}.delay(1100))},addZero:function(b){for(var a=0;a<b.length;a++)if(2>b[a].toString().length)return b[a]="0"+
b[a].toString(),b},formatToInt:function(b){for(var a=0;a<b.length;a++)parseInt(b[a]);return b},judgeTime:function(b){if(0>b[2]&&0<b[1])return b[2]=59,b[1]--,b;if(0>b[2]&&0==b[1]&&0<b[0])return b[2]=59,b[1]=59,b[0]--,b;0==b[2]&&(0==b[1]&&0==b[0])&&($clear(this.s),document.getElement(".desc")&&($clear(this.d),document.getElement(".desc").innerHTML=0),this.isReload&&("function"==typeOf(this.isReload)?this.isReload():location.reload()))},calcTime:function(b){if(b.dom){var a=b.time;this.addZero(a);this.formatToInt(a);
a[2]--;this.judgeTime(a);this.addZero(a);b=b.dom;if(a[3]){if(b.day&&(b.day.innerHTML=a[3]),b.second){var c=b.second.getParent("span");c&&c.hide()}}else if(b.day&&(c=b.day.getParent("span"))&&c.hide(),b.second)b.second.innerHTML=a[2];b.minute&&(b.minute.innerHTML=a[1]);b.hour&&(b.hour.innerHTML=a[0])}},calcDesc:function(){this.desc--;document.getElement(".desc").innerHTML=this.desc;0==this.desc&&(this.desc=10)}});